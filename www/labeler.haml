- require 'base64'
%html
  %head
    %title Labeler
    :css
      #canvas {
        border: 1px black solid;
        width: 100%;
        height: 100px;
      }
      #throbber-background {
        position: absolute;
        left: 0px;
        top: 0px;
        width: 100%;
        height: 100%;
        text-align: center;
        z-index: 1000;
        background-color: black;
        opacity: 0.2;
        filter: alpha(opacity=20);
        -moz-opacity: 0.2;
      }
      #throbber-foreground {
        position: relative;
        width: 300px;
        height: 90px;
        margin: 100px auto;
        background-color: #fff;
        padding: 15px;
        padding-top: 50px;
        text-align: center;
        z-index: 1001;
        font-family: sans-serif;
      }
      #cursor {
        background-color: red;
        width: 1px;
        height: 100px;
        position: absolute;
        top: 1px;
      }
  %body
    %div(id='outside-canvas' style='position:relative')
      %div(id='cursor')
      %canvas(id='canvas' width='50' height='100')
        HTML5 Canvas element not supported.
    %button(id='play-button' class='clickable' disabled='disabled') Play
    %div(id='throbber-background')
    %div(id='throbber-foreground')
      Loading...
      %br
      %br
      %img{:id => 'animated-throbber', :src => "data:image/gif;base64,#{Base64.encode64(File.read('../media/loading-animated.gif'))}"}
    %script(src="../tools/require.js")
    - if ENV['ENV'] == 'production'
      %script window.SM2_DEFER = true;
      %script(src="js/main.js")
      %script(src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js")
      :javascript
        require(["main", "jquery"], function(main, jquery) {
          jquery.noConflict(); // remove $ global
        });
    - else
      :javascript
        window.SM2_DEFER = true;
        require.config({
          baseUrl: "js",
          paths: {
            "jquery": "../../vendor/jquery/jquery-1.7.2",
            "soundmanager2": "../../vendor/soundmanagerv297a-20120513/script/soundmanager2",
            "cs": "../../tools/cs",
            "coffee-script": "../../tools/coffee-script"
          },
          waitSeconds: 5
        });
        require(["main", "jquery"], function(main, jquery) {
          jquery.noConflict(); // remove $ global
        });
